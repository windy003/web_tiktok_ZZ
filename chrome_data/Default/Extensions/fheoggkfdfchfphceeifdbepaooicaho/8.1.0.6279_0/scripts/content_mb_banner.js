/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2025 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="SEND_TELEMETRY",t="SHOW_MB_SIDEBAR",n="MB_VIDEO_FLAGGED",i="PING_CONTENT_MB_BANNER",s="MB_BANNER_SHOW",o="MB_BANNER_REMOVE",a="BROADCAST_MB_UPDATE_UI",r={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},l=(Object.values(r).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:_,...c}=r,d={name:"BLOCK_PAGE_WHITELIST",type:"array"},p={name:"POPUP_STATS",type:"object"},E={name:"RAT_DETECTION_WHITELIST",type:"array"},m={name:"LAST_ANTITRACKER_SCAN_RESULT",type:"object"},u={name:"ANTITRACKER_UPSELL_TASK",type:"object"},T={name:"FINGER_PRINT",type:"number"},g={name:"FIRST_PARTY",type:"number"},h={name:"THIRD_PARTY",type:"number"},N={name:"TRACKER_DOMAIN_LIST",type:"array"},A={name:"ANTITRACKER_WHITELIST",type:"array"},S={name:"TYPOSQUATTING_WHITELIST",type:"array"},y={name:"CACHE_TAB_DATA",type:"object"},I=chrome,D={GREEN:0,YELLOW:1,RED:2,GREY:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"GREY"!==e&&(yield this[e])}},C=1,b=2,O=3,f=0,w=1,L=3,v=2,R="1.0.0.41",B=-1,P=0,k=1,M=2,F=3,U=70,K=31,V=16,x=1,W=(e,t)=>Array.from(Array(t+1).keys()).slice(e),H=I.runtime.getURL(""),G={fingerPrintDomains:T.name,firstParty:g.name,thirdPartyTrackers:h.name},$="snoozed",q="enabled";const Y=e=>{"undefined"!=typeof document&&null!==document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e))};const z=0,j="PRINT_IN_BACKGROUND",X={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4,ALL_IN_BACKGROUND:99},Q=1,J=2,Z=3,ee=4,te={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},ne={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};const ie=new class{constructor(){this.storageChecked=!1,this.logLevel=null,this.queue=[];const e="MCLOGLEVEL";chrome?.storage?.local.get([e]).then((t=>{const n=Object.values(X).includes(t[e]);this.logLevel=n?t[e]:z,this.logLevel!==X.NONE&&this.queue.forEach((({callback:e,message:t,processType:n})=>{e(t,n)})),this.queue=[],this.storageChecked=!0}))}log(e,t=null){this.storageChecked?this.processLog(e,Q,t,this.logLevel):this.queue.push({callback:this.log.bind(this),message:e,processType:t})}error(e,t=null){this.storageChecked?this.processLog(e,J,t,this.logLevel):this.queue.push({callback:this.error.bind(this),message:e,processType:t})}warn(e,t=null){this.storageChecked?this.processLog(e,Z,t,this.logLevel):this.queue.push({callback:this.warn.bind(this),message:e,processType:t})}debug(e,t=null){this.storageChecked?this.processLog(e,ee,t,this.logLevel):this.queue.push({callback:this.debug.bind(this),message:e,processType:t})}processLog(e,t,n,i){if(i===X.NONE)return;let s="chrome-extension:"===location.protocol?te.BACKGROUND:te.CONTENT;n&&te[n]&&(s=n);const o=this.formatDateWithMilliseconds(new Date),a=t===J?e:`%c[${s} ${o} ]: %c${e}`;s===te.CONTENT&&this.logLevel===X.ALL_IN_BACKGROUND&&chrome.runtime.sendMessage({command:j,logMessage:a,processType:s,logType:t,logLevel:i}),this.printLog(a,s,t,i)}formatDateWithMilliseconds(e){return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).format(e)}.${e.getMilliseconds().toString().padStart(3,"0")}`}printLog(e,t,n,i){const s=ne.DEFAULT,o=ne[t]||s;if(i>=X.ERROR&&n===J&&console.error(e),i>=X.INFO&&n===Q&&console.log(e,o,s),i>=X.WARN&&n===Z){const t="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${e}`,t,o,s)}if(i>=X.DEBUG&&n===ee){const t="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${e}`,t,o,s)}}},se=(e,t=null,n)=>{"function"==typeof n?chrome.runtime.onMessage.addListener(((i,s,o)=>{if(s.id===chrome.runtime.id&&"object"==typeof i&&!Array.isArray(i)&&i?.ipcId===e)return n({promises:t,request:i,sender:s,sendResponse:o})})):ie.error("Provided with invalid callback function")};class oe{constructor(e){this.pingCommand=e,this.basePingListener(),this.addIdentifier()}basePingListener(e=null){se("WA",null,(({request:t,sendResponse:n})=>{const{command:i}=t;if(i===this.pingCommand)return ie.debug(`File Injection [pinged]: Received ${i} command`),n({content:!0}),"function"==typeof e&&e(),!0}))}addIdentifier(){Y((()=>{const e=document.createElement("span");e.id=this.pingCommand,e.style.cssText="display:none",document.body.appendChild(e)}))}}const ae=async(e,t,n,i)=>{try{chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},{},(()=>{chrome.runtime.lastError}))}catch(e){ie.warn(`[broadcast] Unexpected error when calling command: "${t}", err: ${e.message}`)}},re=(e,t,n,i,s=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');const o={};return"number"==typeof s&&(o.frameId=s),chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},o)},le=(e,t={},n)=>(async(e,t,n={},i={})=>{try{if(i?.tabId){const{tabId:s,frameId:o}=i;return await re(e,t,n,s,o)}if(i?.broadcast){const s=await chrome.tabs.query({}),{broadcastIgnoreId:o=[]}=i;return s.filter((({id:e})=>!o.includes(e))).forEach((({id:i})=>{ae(e,t,n,i)})),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...n})}catch(e){return ie.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,n);class _e{static geti18nRes(e,t=[]){let n=I.i18n.getMessage(e,t);const i=I.i18n.getMessage("res_PRODUCT_NAME_TRADEMARKED");return n=n.replace(/%PRODUCTNAME%/g,i),n}static getResStr(e,t){const n=_e.geti18nRes(e);t("??"===n?"":n)}static async getFileSource(e){try{return(await fetch(I.runtime.getURL(e))).text()}catch(e){return""}}}class ce{constructor(e=null,t=document){if(this.resourcerequestor=_e,this.document=t,e){const t=this.document.querySelectorAll(`#${e}`);t&&(this.document=t[0].contentDocument)}this.localeData=this.localeData.bind(this),this.fillText=this.fillText.bind(this),this.fillLocalizedTexts=this.fillLocalizedTexts.bind(this),this.fillInputPlaceHolders=this.fillInputPlaceHolders.bind(this)}localeData(e,t=[]){return this.resourcerequestor.geti18nRes(e,t)}fillText(e,t){const n=this.document.getElementById(e);if(n){const e=n.getAttribute("x-mcinsertposition");if(e)return void n.insertAdjacentText(e,t);n.textContent=t,n.setAttribute("x-mcl10nprocessed",!0)}}fillLocalizedTexts(){for(const{id:e}of this.document.querySelectorAll("*[x-mclocalizedtext]:not([x-mcl10nprocessed=true])")){const t=this.localeData(e);if(null==t)return!1;this.fillText(e,t)}return!0}fillInputPlaceHolders(){for(const{id:e}of this.document.querySelectorAll("*[x-inputplaceholder]")){const t=this.localeData(e),n=this.document.getElementById(e);if(null==t)return!1;null!=n&&n.setAttribute("placeholder",t)}return!0}init(){this.fillLocalizedTexts(),this.fillInputPlaceHolders()}}const de=e=>{let{top:t,left:n}=pe(e);return t<0&&(t=0),n<0&&(n=0),{top:t,left:n}},pe=e=>{const t=e.getBoundingClientRect(),n=window.pageYOffset||window.scrollY,i=window.pageXOffset||window.scrollX;return{top:Math.round(t.top+n),left:Math.round(t.left+i),bottom:Math.round(t.bottom+n),right:Math.round(t.right+i)}},Ee="NO_VIDEO_PLAYING",me="NO_AUDIO_PLAYING",ue="FEATURE_OFF",Te="DISPLAYED";const ge="unknown",he={EVENT_NAME:"wa_deepfake_detection",EVENT_ID:"wa_deepfake_detection"},Ne="screen",Ae="event",Se="ai_audio_detected",ye="ai_audio_not_detected",Ie="no_suite",De="unable_read_csp_id",Ce={IMPRESSION:"impression",ACCEPTED:"accepted",FAQ_CLICKED:"faq_request",CLOSED:"closed",FADE_AWAY:"fades_away",EXPAND:"expand",SNOOZED:"snoozed",TOGGLE_ON:"toggle_on",TOGGLE_OFF:"toggle_off",BACK_TO_ENTRY:"back_to_entry",FAQ_SUPPORT_CLICKED:"support_request",BACK_TO_DFD_PANEL:"back_to_deepfake_side_panel"},be={ACTIVATION_ENROLLMENT_BANNER:"wa_deepfake_activation_enrollment_banner",ACTIVATION_ENROLLMENT_BANNER_SUCCESS:"wa_deepfake_activation_success",AI_ANNOTATION_BANNER:"wa_deepfake_banner_annotation",SIDEBAR_PANEL:"wa_deepfake_side_panel",SIDEBAR_FAQ_PANEL:"wa_deepfake_faq"},Oe={EMBEDED_BANNER:"embedded",PAGE_BANNER:"page",AI_ANNO_FULL_BANNER:"banner_only",AI_ANNO_HOVER_BANNER:"icon_and_banner_on_hover",AI_ANNO_ICON_BANNER:"icon_only"},fe={AUDIO_PLAYING:"audio_playing",X_CLICKED:"x_clicked",ACTIVATE_BTN_CLICKED:"activate_button_clicked",ACTIVATION_LEARM_MORE_CLICKED:"learn_more_clicked",ACTIVATION_ACCEPT:"deepfake_activation_accepted",ANNO_BANNER_CLICKED:"banner_clicked",ANNO_BANNER_FADE_AWAY:"time_elapsed",ANNO_BANNER_HOVER:"banner_hover",ANNO_BANNER_CLICKED_FOR_SIDEBAR:"deepfake_banner_annotation_clicked",MAIN_SIDEBAR_DFD_CLICKED:"sidebar_panel_deepfake_icon_clicked",FAQ_PANEL_BACK_CLICKED:"back_from_faq_clicked",SNOOZE_OPTION_SELECTED:"snooze_option_selected",AUDIO_DETECTION_TOGGLE_BTN_CLICKED:"audio_detection_toggle_switched",DFD_PANEL_BACK_CLICKED:"back_button_clicked",DFD_PANEL_BASICS_BTN_CLICKED:"deepfake_basics_button_clicked",DFD_PANEL_BUY_BTN_CLICK:"buy_now_button_clicked",DFD_PANEL_ON_TRIAL_BUY_BTN_CLICK:"buy_now_on_trial_clicked",DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED:"contact_support_link_clicked",DFD_FAQ_PANEL_BACK_CLICKED:"back_button_clicked",DFD_FEEDBACK_THUMB_UP:"feedback_thumb_up",DFD_FEEDBACK_THUMB_DOWN:"feedback_thumb_down",DFD_FEEDBACK_SUBMIT:"feedback_submit"},we={NO_ACTION:"no_action",WA_INTERACTION:"wa_interaction"},Le={GENERIC_ERR:"generic_error",NO_AUDIO_PLAYING:"no_audio_playing",NO_VIDEO_PLAYING:"no_video_playing",DETECTION_OFF:"detection_off",NOTIFICATION_PAUSE:"notification_paused",GRAPH_DISPLAYED:"graph_displayed"};class ve{static toTlmWpsCspClientId(e){let t=e;return null===t?t=Ie:void 0===t&&(t=De),t}static toTlmAudioGraphStatus(e,t){let n=Le.NOTIFICATION_PAUSE;if(t)return n;if(n=Le.GENERIC_ERR,!e)return n;switch(e){case Ee:n=Le.NO_VIDEO_PLAYING;break;case me:n=Le.NO_AUDIO_PLAYING;break;case ue:n=Le.DETECTION_OFF;break;case Te:n=Le.GRAPH_DISPLAYED}return n}static toTlmActivatedDays(e){let t=ge;if(e<=0)return t;const n=Date.now()-e;return t=Math.ceil(n/864e5),t}}const Re="whitelist",Be="preference",Pe="statistics",ke="about",Me="Block_Page",Fe="BrowserAction_Clicked",Ue="Browser_Navigate",Ke="DarkWebMonitoring",Ve="ProfileInfo",xe="RemoteAccessTrojan",We="Secure_Search_Hit",He="SideBar_Panel",Ge="wa_site_report_impression",$e="SMA_Reputation",qe="Typosquatting",Ye="WSS_Analytics",ze={EVENT_NAME:"AdvancedProtectionSignals",IMPRESSION_BALLOON:"IMPRESSION_BALLOON",IMPRESSION_HOVER:"IMPRESSION_HOVER",CLOSE_BALLOON:"CLOSE_BALLOON",TOAST_CLOSE:"TOAST_CLOSE",TOAST:"toast",BALLOON:"balloon"},je="BrowserActionClicked",Xe="Typosquatting",Qe="BlockPage",Je="SecureSearchHit",Ze="SideBarPanel",et="SMAReputation",tt="Impression",nt="WebAdvisor",it={MAIN:"Main"},st="CloseClicked",ot={ACKNOWLEDGED:"Acknowledged",WHITELISTED:"Whitelisted"},at="AcceptRisk",rt="Close",lt="GotIt",_t="Hover",ct="About",dt="Preferences",pt="Whitelist",Et="UserStatistics",mt="Green",ut="Yellow",Tt="Red",gt="Grey",ht="UNKNOWN",Nt="Typosquatting",At="Phishing",St="DefaultSearch",yt={CLICK:"click",KEYDOWN:"keydown",RETURN_KEY_CODE:13,SHOW:"show",SEARCH_SUGGEST_KEY_CODES:[8,32,46,...W(48,57),...W(65,90),...W(96,107),...W(109,111),...W(186,192),...W(219,222)]},It={LOADED:"Loaded",CHECKED:"checked",UNKNOWN:"UNKNOWN",ACTION_PANEL:"ActionPanel",ACCEPTED:"Accepted",DECLINED:"Declined",SETTINGS_TAB_PREFIX:"settings_tab_",GREEN:"GREEN",YELLOW:"YELLOW",RED:"RED",PREFERENCE:"Preference",DEFAULT:"default"};class Dt{static toTelemetryBlockState(e){let t=ht;switch(e){case D.GREEN:t=mt;break;case D.YELLOW:t=ut;break;case D.RED:t=Tt;break;case D.GREY:t=gt;break;case D.TYPOSQUATTING:t=Nt;break;case D.PHISHING:t=At}return t}static toTelemetrySettingTab(e){let t=dt;switch(e){case Re:t=pt;break;case Pe:t=Et;break;case ke:t=ct}return t}}class Ct{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:n}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},i={};return i[O]=n,i[C]=t,i[b]=e,i[v]}}const{SYSTEM:bt,USER:Ot}={SYSTEM:0,USER:1},ft=Ct.getBrowserSuffix(),wt={DEV_MODE:{scope:bt,name:"dev_mode",value:!1},AFF_ID:{scope:bt,name:"*Affid",value:0},BINARY_VERSION:{scope:bt,name:"version",value:null},EXTENSION_VERSION_CH:{scope:bt,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:bt,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:bt,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:bt,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:bt,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:bt,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:Ot,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${ft}`,value:""},SECURE_SEARCH_REGEXES:{scope:Ot,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:Ct.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:bt,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:Ot,name:`*SSDateStampShowedToast${ft}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:bt,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:Ot,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:Ot,name:`*SSToastChoice${ft}`,value:!1},SS_DEF:{scope:bt,name:`*SS_DEF${ft}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:bt,name:`*AnnotationsChoiceExplicit${ft}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:Ot,name:`*CurrentSAOInExtension${ft}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:Ot,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:Ot,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:bt,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:bt,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:bt,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:bt,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:bt,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:bt,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:bt,name:"CryptojackingDisabled",value:!0},SMA_USER_TOGGLE:{scope:bt,name:`sma_user_toggle${ft}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:bt,name:`sma_annotation_options${ft}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:bt,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:bt,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:bt,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:bt,name:"*CounterDownloadsBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:Ot,name:"*WhiteList",value:""},TS_WHITELIST:{scope:Ot,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:bt,name:"CSPIdValue",value:"__not_available__"},MTI_CLIENT_ID:{scope:bt,name:"gti_client_id",value:""},JWT_TOKEN_ENABLED:{scope:bt,name:"jwt_token_enabled",value:!1},UNINSTALL_SURVEY_ENABLED:{scope:bt,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:bt,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:bt,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:bt,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:bt,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:bt,name:"aps_toggle_setting",value:!0},APS_SHOPPING_COHORT:{scope:bt,name:"aps_shopping_cohort",value:0},ALT_TRIGGER:{scope:bt,name:"alt_triggers_cohort",value:0},ANNOTATION_JOURNEY_COHORT:{scope:bt,name:`annotation_journey_cohort${ft}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:Ot,name:`aj_toast${ft}`,value:null},DAILY_GREEN_URLS_TO_COLLECT:{scope:bt,name:"daily_green_urls_to_collect",value:0},FEATURE_COLLECTION_ENABLED:{scope:bt,name:"feature_collection_enabled",value:!1},DAILY_GREEN_URLS_RESET_RATE:{scope:bt,name:"daily_green_urls_reset_rate",value:0},HERON_REPORT_ENABLED:{scope:bt,name:"heron_report_enabled",value:!1},SAMPLING_RATE_BLOCK_DEFAULT:{scope:bt,name:"sampling_rate_block_default",value:100},SAMPLING_RATE_USER_FEEDBACK:{scope:bt,name:"sampling_rate_user_feedback",value:1},WA_EXTN_UUID:{scope:Ot,name:`wa_extn_uuid${ft}`,value:"",writeOnly:!0},MOCKINGBIRD_ENABLED:{scope:bt,name:"mockingbird_enabled",value:!0},TYPOSQUAT_ENABLED:{scope:bt,name:"typosquat_enabled",value:!0},DFD_FEEDBACK_ENABLED:{scope:bt,name:"dfd_feedback_enabled",value:!1},NATIVE_DEVICE_ID:{scope:bt,name:"context_device_id",value:"unknown"}};class Lt{static getResetValues(){return{blockedIframes:[],tabDomainTrusted:!1,mockingbird:{},mbVideoId:null}}static getDefaultValues(){return Lt.getResetValues()}reset(e){const t=qt.localStore.get(y.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;qt.htiReportHandler.checkBacklog(e,t[e],n),this.update(e,Lt.getResetValues())}get(e){return qt.localStore.get(y.name,{})[e]||Lt.getDefaultValues()}set(e,t){const n=qt.localStore.get(y.name,{});n[e]=t,qt.localStore.set(y.name,n)}delete(e){const t=qt.localStore.get(y.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;qt.htiReportHandler.checkBacklog(e,t[e],n),delete t[e],qt.localStore.set(y.name,t)}update(e,t){const n=this.get(e);this.set(e,{...n,...t})}setTabBlockPageData(e,t,n=!0){const i={...this.get(e),blockPageData:t};this.set(e,i),n&&!t.url.includes("chrome://extensions/")&&qt.htiReportHandler.addReportToBacklog(e,i)}addBlockedFrame(e,t){const n=this.get(e);n.blockedIframes.push(t),this.update(e,n),qt.htiReportHandler.addIFrameReportToBacklog(e,n)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){const t=this.get(e);t.blockedIframes=[],this.update(e,t)}}const vt="ph",Rt="www.siteadvisor.com/",Bt="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",Pt="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",kt="https://sadownload.mcafee.com/products/SA/Win/extensions/sailor/condition.json",Mt="https://sadownload.mcafee.com/products/SA/Win/extensions/antitracker/all_trackers.json",Ft="https://threat.api.mcafee.com/",Ut="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/condition.json",Kt="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/featureflag",Vt=new Set(["www.mcafee.com"]),xt="PAGES_SCANNED",Wt="PAGES_BLOCKED",Ht="DOWNLOADS_SCANNED",Gt="DOWNLOADS_BLOCKED";class $t{static init(){const e=this.read(),{PAGES_SCANNED:t,PAGES_BLOCKED:n,DOWNLOADS_SCANNED:i,DOWNLOADS_BLOCKED:s}=qt.nativeSettings,o={pagesScanned:t.value||e.pagesScanned,pagesBlocked:n.value||e.pagesBlocked,downloadsScanned:i.value||e.downloadsScanned,downloadsBlocked:s.value||e.downloadsBlocked};qt.localStore.set(p.name,o)}static add(e){const t=this.read();switch(e){case xt:t.pagesScanned++;break;case Wt:t.pagesBlocked++;break;case Ht:t.downloadsScanned++;break;case Gt:t.downloadsBlocked++;break;default:return}qt.localStore.set(p.name,t)}static read(){const e={pagesScanned:0,pagesBlocked:0,downloadsScanned:0,downloadsBlocked:0},t=qt.localStore.get(p.name);return t&&Object.assign(e,t),e}}const qt={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:v,sessionStore:null,localStore:null,idb:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new Lt,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:Bt,tldParser:null,urlParser:null,trustedDomains:Vt,nativeSettings:wt,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],preconditions:null,platform:class{static debounce(e,t,n){let i;return(...s)=>{const o=n&&!i;clearTimeout(i),i=setTimeout((()=>{i=null,n||e(...s)}),t),o&&e(...s)}}static isBrowserEN(){return I.i18n.getUILanguage().toLowerCase().startsWith("en")}static isChromeBrowser(){const e=navigator.userAgent.toLowerCase();return!(!e.includes("chrome")||!1==!!chrome)&&(!e.includes("opr")&&!e.includes("edg"))}static isWindowsOS(){const{platform:e}=navigator;return e&&-1!==e.search("Win")}static getPlatform(){const{platform:e}=navigator;let t=f;return-1!==e.search("Mac")?t=w:-1!==e.search("iPhone")&&(t=L),t}}.getPlatform(),launchPageOnInstall:!1,wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:Pt,engineCheckInterval:864e5,ENGINES_VERSION:R,AUTO_PLAY_NOTIFICATION_ENABLED:!1,DLS_POPUP_FOR_WA_NATIVE_ENABLED:!1,WA_EXTN_CONDITION_URL:Ut,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,typosquattingHandler:null,URL_DOWNLOAD_MAX_CACHE:100,URL_DOWNLOAD_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["gp/cart"]}},email:{"mail.google.com/mail":{selector:"div[role=main] a"},"outlook.live.com/mail":{selector:"div[role=main][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=main][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=main][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,wpsRequestedSettings:["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"],permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com","protection-stg-roadhouse-pub.dvqa.mcafee.com","protection-stg2-roadhouse-pub.dvqa.mcafee.com","protection-stg3-roadhouse-pub.dvqa.mcafee.com"],mtiRequestor:null,htiServer:Ft,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6",sailer:null,sailorConditionUrl:kt,allTrackerUrl:Mt,antitrackData:new class{init(){qt.wssMessageDispatcher?.nativeDispatcher?.getATUpsellFlag((e=>{e?.antitrack_upsell_config?.enabled&&qt.scheduleManager.setEnabled(u.name,!0)}))}isActive(){return!qt.isAntitrackerExtInstalled}isWhiteListed(e,t){return qt.localStore.get(A.name,["mcafee.com"]).some((t=>e.includes(t)))||t.includes("fi")}addCountTo(e,t=1){const n=qt.localStore.get(e,0);qt.localStore.set(e,n+t)}getAndResetCount(e){const t=qt.localStore.get(e,0);return qt.localStore.set(e,0),t}addLatestDomain(e,t){try{this.addCountTo(t);const n=new Date,i=`${n.getFullYear()}${n.getMonth()}${n.getDate()}`,s=new URL(e).hostname.replace("www.",""),o=this.getDomainList();o.dataDate!==i&&(o.dataDate=i,o.domainHistoryMap={}),o.lastVisited=s,o.domainHistoryMap=o.domainHistoryMap||{},(o.domainHistoryMap[s]||Object.keys(o.domainHistoryMap).length<50)&&(o.domainHistoryMap[s]=(o.domainHistoryMap[s]||0)+1),qt.localStore.set(N.name,o)}catch(e){ie.log(`[AntitrackerData] Error adding last domain: ${e.message||e}`)}}getDomainList(){const e=qt.localStore.get(N.name,{});return JSON.parse(JSON.stringify(e))}updateWPS(e){try{e=e?JSON.parse(e):{};const{pagesBlocked:t=0,pagesScanned:n=0}=$t.read();let i=0;Object.values(G).forEach((t=>{const n=t.toLowerCase(),s=(e[n]||0)+this.getAndResetCount(t);e[n]=s,i+=s})),e.total_trackers=i,e.blocked_pages=t,e.scanned_pages=n,e.last_visited="",e.domain_history="",0===e.total_trackers&&0===e.blocked_pages&&0===e.scanned_pages&&""===e.last_visited&&""===e.domain_history||!this.isSameAsLastScan(e)&&qt.wssMessageDispatcher&&(qt.wssMessageDispatcher.nativeDispatcher.updateAntitrackerToWPS(e),qt.localStore.set(m.name,e))}catch(e){ie.log(`[AntitrackerData] Error sending AT updates to WPS: ${e.message}`)}}getDomainHistory(e={}){let t="";const n=Object.keys(e);if(0===n.length)return t;n.sort(((t,n)=>e[n]-e[t]));for(let i=0;i<n.length&&i<5&&n[i];i++){const s=n[i];t+=`${s},${e[s]},`}return t.slice(0,-1)}isSameAsLastScan(e){const t=qt.localStore.get(m.name,{}),n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}},isAntitrackerExtInstalled:!1,sendDataToWpsFlag:!1,analyticsContentVersion:"1.0.1",htiReportHandler:null,mockingBirdHandler:null,featureFlagManager:null,featureFlagServer:Kt,featureFlagIsFreshInstalled:!1,dfdActiveTabRecording:!1,dfdRecordingTimer:-1},Yt=(d.name,S.name,d.name,E.name,"ADD"),zt="REMOVE",jt={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class Xt{static getResString(e,t){jt.ANNOTATION.resourceRequestor.getResStr(e,(n=>{n?t(n):jt.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class Qt{static async toHTICategoriesString(e,t=!1){const n=e=>new Promise((t=>{Xt.getResString(e,(e=>t(e)))})),i=async(e,t)=>{const i={},s=await n(`category_id_${e}_name`);if(i.name=s,t){const t=await n(`category_id_${e}_description`);i.description=t}return i},s=[];for(const n of e)s.push(i(n,t));return await Promise.all(s)}static browserTypeToString(e=!1){let t="";switch(v){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;case 4:t="SF";break;default:t="UN"}return e?t.toLowerCase():t}static toAnnotationImageClass(e){let t="";switch(Qt.toColor(e)){case P:t="green";break;case M:t="red";break;case k:t="yellow";break;case F:t="grey"}return t}static isPhishingURI(e){return e&&e.includes(vt)}static toBlockState(e){const t=Qt.toColor(e);return t===k&&Qt.isPhishingURI(e.category)?D.PHISHING:isNaN(t)?D.GREY:t}static toColor(e){let t=B;return e&&void 0!==e.trust?(t=e.trust>=U?P:e.trust>=K?F:e.trust>=V?k:e.trust>=x?M:B,t):t}static toSiteReportUrl(e){return`${I.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){return e.startsWith(H)}static isAnyExtensionUrl(e){return e.startsWith(`${H.split("://")[0]}://`)}static isSafeUrl(e){return Qt.isSiteAdvisorUrl(e)||Qt.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${Rt}`)||e.startsWith(`https://${Rt}`)}static isPropertRedirectUrl(e){return Qt.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e=""){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static async blockRequest(e,t,n){const i=await I.declarativeNetRequest.getDynamicRules();0===i.filter((e=>e.condition.urlFilter===t)).length&&Qt.addDynamicRule(e,t,n,i.length+1,0)}static async addDynamicRule(e,t,n,i,s){if(s>=10)ie.error(`Unable to add dynamic rule for tabId:${e}, on url: ${t}. message: ${n}`);else try{await I.declarativeNetRequest.updateDynamicRules({addRules:[{id:i,condition:{urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]}),ie.log(`${n} ${t} ${e}`)}catch(o){Qt.addDynamicRule(e,t,n,i+1,s+1)}}static async updateExcludedTabInSession(e,t){try{const n=999999,i=(await I.declarativeNetRequest.getSessionRules()).find((e=>e.id===n));let s=i?.condition?.tabIds||[],o=!1;const a=s.indexOf(e);t===Yt&&-1===a?(s.push(e),o=!0):t===zt&&-1!==a&&(s=s.filter((t=>t!==e)),o=!0),o&&I.declarativeNetRequest.updateSessionRules({removeRuleIds:[n],addRules:[{id:n,condition:{tabIds:s},action:{type:"allow"}}]})}catch(e){ie.error(e.message)}}static updateHTIGlobalsAfterNativeConnection(){const e=qt.nativeSettings.MTI_CLIENT_ID.value,t=qt.nativeSettings.CSP_ID_SETTING.value,n=qt.nativeSettings.JWT_TOKEN_ENABLED.value;""!==e&&qt.mtiRequestor.setGlobals({clientIdGuid:e}),"__not_available__"!==t&&qt.mtiRequestor.setGlobals({cspid:t}),"boolean"==typeof n&&qt.mtiRequestor.setGlobals({jwtEnabled:n})}static newGuid(){const e=new Uint8Array(24);let t=Date.now().toString()+Math.random().toString().substring(2);for(let n=0;n<24;++n)t+=e[n].toString();let n="{";for(let e=0;e<36;++e)if(8===e||13===e||18===e||23===e)n+="-";else{n+=t[Math.floor(Math.random()*t.length)]}return n+="}",n}}class Jt{constructor(e){this._options=e,this.TELEMETRY_HANDLERS=this.initializeTelemetryHandler()}fetchTelemetryHandlers(e){const t=[];return this.TELEMETRY_HANDLERS.forEach((n=>{n.trigger.identifier&&e!==n.trigger.identifier||t.push(n)})),t}initializeTelemetryHandler(){return[{trigger:{identifier:Me,sendTelemetry:this._options.isFromBackground||!1},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:tt,colour:Dt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Me,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Me,sendTelemetry:this._options.isFromForeground||!1},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:at,colour:Dt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Me,browser:Qt.browserTypeToString(),metadata:`url=${this._options.url}`}}]},{trigger:{identifier:Me,selector:"#sidebar-close",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:Qe,interaction_type:st,colour:Dt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:"UNKNOWN",_event_name:Me,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Fe,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:je,interaction_type:nt,badge_count:this._options.count,_event_name:Fe,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ue,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,url:this._options.url,browser:Qt.browserTypeToString(),_event_name:Ue}}]},{trigger:{identifier:Ve,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Ve,interaction_type:tt,tab:Dt.toTelemetrySettingTab(Be),_event_name:Ve,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ve,selector:`#${It.SETTINGS_TAB_PREFIX}${Be}`,action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:Ve,interaction_type:tt,tab:Dt.toTelemetrySettingTab(Be),_event_name:Ve,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ve,selector:`#${It.SETTINGS_TAB_PREFIX}${Re}`,action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:Ve,interaction_type:tt,tab:Dt.toTelemetrySettingTab(Re),_event_name:Ve,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ve,selector:`#${It.SETTINGS_TAB_PREFIX}${ke}`,action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:Ve,interaction_type:tt,tab:Dt.toTelemetrySettingTab(ke),_event_name:Ve,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ve,selector:`#${It.SETTINGS_TAB_PREFIX}${Pe}`,action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:Ve,interaction_type:tt,tab:Dt.toTelemetrySettingTab(Pe),_event_name:Ve,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:We,sendTelemetry:!0},messages:[{template:{name:Je,search_type:St,_event_name:We,browser:Qt.browserTypeToString(),type_tag:this._options.typeTag,provider_type:this._options.engineName}}]},{trigger:{identifier:He,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Ze,interaction_type:it.MAIN,_event_name:He,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:Ge,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Ge,block_state:Dt.toTelemetryBlockState(this._options.blockState),site_categories:this._options.siteCategories,url:this._options.displayUrl,_event_name:Ge,browser:Qt.browserTypeToString()}}]},{trigger:{identifier:$e,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:et,interaction_type:tt,_event_name:$e,browser:Qt.browserTypeToString(),site:this._options.site,color:It.GREEN,count:this._options[It.GREEN]}},{template:{analyticsSDK:!0,name:et,interaction_type:tt,_event_name:$e,browser:Qt.browserTypeToString(),site:this._options.site,color:It.RED,count:this._options[It.RED]}},{template:{analyticsSDK:!0,name:et,interaction_type:tt,_event_name:$e,browser:Qt.browserTypeToString(),site:this._options.site,color:It.YELLOW,count:this._options[It.YELLOW]}},{template:{analyticsSDK:!0,name:et,interaction_type:tt,_event_name:$e,browser:Qt.browserTypeToString(),site:this._options.site,color:It.UNKNOWN,count:this._options[It.UNKNOWN]}}]},{trigger:{identifier:qe,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,name:Xe,interaction_type:tt,browser:Qt.browserTypeToString(),_event_name:qe}}]},{trigger:{identifier:xe,state:It.LOADED,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:xe,interaction_type:tt,browser:Qt.browserTypeToString(!0),url:this._options.url,_event_name:xe}}]},{trigger:{identifier:xe,selector:"#rat_detection_got_it_btn",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:xe,interaction_type:ot.ACKNOWLEDGED,browser:Qt.browserTypeToString(!0),url:this._options.url,_event_name:xe}}]},{trigger:{identifier:xe,selector:"#sidebar_rat_detection_whitelist_btn",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:xe,interaction_type:ot.WHITELISTED,browser:Qt.browserTypeToString(!0),url:this._options.url,_event_name:xe}}]},{trigger:{identifier:xe,selector:"#sidebar-close",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,name:xe,interaction_type:st,browser:Qt.browserTypeToString(!0),url:this._options.url,_event_name:xe}}]},{trigger:{identifier:Ye,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:Ye,message:this._options.message}}]},{trigger:{identifier:Ke,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:Ke,category:Ke,action_type:this._options.eventAction||It.UNKNOWN,browser:"un"===Qt.browserTypeToString(!0)?It.UNKNOWN:Qt.browserTypeToString(!0),count:this._options.count||It.UNKNOWN,type:this._options.type,flow_id:this._options.flowId}}]},{trigger:{identifier:ze.EVENT_NAME,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ze.EVENT_NAME,name:ze.EVENT_NAME,action_type:tt,browser:Qt.browserTypeToString(!0),type:ze.TOAST,sequence:It.DEFAULT,trigger:It.DEFAULT,color:It.DEFAULT}}]},{trigger:{identifier:ze.IMPRESSION_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ze.EVENT_NAME,name:ze.EVENT_NAME,action_type:tt,browser:"un"===Qt.browserTypeToString(!0)?It.UNKNOWN:Qt.browserTypeToString(!0),type:ze.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:ze.IMPRESSION_HOVER,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ze.EVENT_NAME,name:ze.EVENT_NAME,action_type:_t,browser:"un"===Qt.browserTypeToString(!0)?It.UNKNOWN:Qt.browserTypeToString(!0),type:ze.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:ze.CLOSE_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ze.EVENT_NAME,name:ze.EVENT_NAME,action_type:rt,browser:"un"===Qt.browserTypeToString(!0)?It.UNKNOWN:Qt.browserTypeToString(!0),type:ze.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:ze.TOAST_CLOSE,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:ze.EVENT_NAME,name:ze.EVENT_NAME,action_type:this._options.gotItButton?lt:rt,browser:"un"===Qt.browserTypeToString(!0)?It.UNKNOWN:Qt.browserTypeToString(!0),type:ze.TOAST,sequence:It.DEFAULT,trigger:It.DEFAULT,color:It.DEFAULT}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:this._options.isFromActivationPage||!1},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.ACTIVATION_ENROLLMENT_BANNER,trigger:fe.AUDIO_PLAYING,action:we.NO_ACTION,is_interactive:!1,browser:Qt.browserTypeToString(!0),interaction:Ce.IMPRESSION,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:"#mb_banner_activate_button",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.ACTIVATION_ENROLLMENT_BANNER,trigger:fe.ACTIVATE_BTN_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.ACCEPTED,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:"#mb_banner_learn_more",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.ACTIVATION_ENROLLMENT_BANNER,trigger:fe.ACTIVATION_LEARM_MORE_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.FAQ_CLICKED,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:"#close_button",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:this._options.screenName,trigger:fe.X_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLOSED,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:this._options.isFromSuccessPage||!1},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.ACTIVATION_ENROLLMENT_BANNER_SUCCESS,trigger:fe.ACTIVATION_ACCEPT,action:we.NO_ACTION,is_interactive:!1,browser:Qt.browserTypeToString(!0),interaction:Ce.IMPRESSION,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"videoBannerShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.AI_ANNOTATION_BANNER,trigger:fe.AUDIO_PLAYING,action:we.NO_ACTION,is_interactive:!1,browser:Qt.browserTypeToString(!0),interaction:Ce.IMPRESSION,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.bannerNodeSelector||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.AI_ANNOTATION_BANNER,trigger:fe.ANNO_BANNER_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.ACCEPTED,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.videoBannercloseBtn||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.AI_ANNOTATION_BANNER,trigger:fe.X_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLOSED,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"videoBannerHover"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.AI_ANNOTATION_BANNER,trigger:fe.ANNO_BANNER_HOVER,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.EXPAND,display_type:Oe.AI_ANNO_HOVER_BANNER,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"videoBannerFadeAway"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.AI_ANNOTATION_BANNER,trigger:fe.ANNO_BANNER_FADE_AWAY,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.FADE_AWAY,display_type:this._options.displayType,detection_status:ye,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:this._options.initTriggerType,action:we.NO_ACTION,is_interactive:!1,browser:Qt.browserTypeToString(!0),interaction:Ce.IMPRESSION,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"snoozeOptionSelected"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:fe.SNOOZE_OPTION_SELECTED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.SNOOZED,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.buyNowBtn||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:this._options.buyNowBtnClickedType,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.ACCEPTED,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:fe.X_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLOSED,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdToggleBtnClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:fe.AUDIO_DETECTION_TOGGLE_BTN_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:this._options.toggleType,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.backToEntryBtn||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:fe.DFD_PANEL_BACK_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.BACK_TO_ENTRY,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.mbBasicButton||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_PANEL,trigger:fe.DFD_PANEL_BASICS_BTN_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.FAQ_CLICKED,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdFaqSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ne,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_FAQ_PANEL,trigger:this._options.triggerForMbFaq,action:we.NO_ACTION,is_interactive:!1,browser:Qt.browserTypeToString(!0),interaction:Ce.IMPRESSION,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdFaqPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_FAQ_PANEL,trigger:fe.X_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLOSED,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.contactSupportLink||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_FAQ_PANEL,trigger:fe.DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.FAQ_SUPPORT_CLICKED,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,selector:this._options.mbFaqBackBtn||"",action:yt.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,type:Ae,event_id:he.EVENT_ID,screen_name:be.SIDEBAR_FAQ_PANEL,trigger:fe.DFD_FAQ_PANEL_BACK_CLICKED,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.BACK_TO_DFD_PANEL,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdFeedbackThumbUp"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,event_id:he.EVENT_ID,type:Ae,screen_name:be.SIDEBAR_PANEL,trigger:fe.DFD_FEEDBACK_THUMB_UP,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLICKED,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdFeedbackThumbDown"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,event_id:he.EVENT_ID,type:Ae,screen_name:be.SIDEBAR_PANEL,trigger:fe.DFD_FEEDBACK_THUMB_DOWN,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLICKED,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]},{trigger:{identifier:he.EVENT_NAME,sendTelemetry:"dfdFeedbackSubmit"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:he.EVENT_NAME,event_id:he.EVENT_ID,type:Ae,screen_name:be.SIDEBAR_PANEL,trigger:fe.DFD_FEEDBACK_SUBMIT,action:we.WA_INTERACTION,is_interactive:!0,browser:Qt.browserTypeToString(!0),interaction:Ce.CLICKED,detection_status:this._options.detection_status,top_level_domain:this._options.topLevelDomain||"unknown",feedback_text_length:this._options.feedbackTextLength||0,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire}}]}]}}class Zt{static sendTelemetryMessages(t,n){const{sendTelemetry:i}=n.trigger,s=n.trigger.action,o=[yt.CLICK];if(n.trigger.selector&&n.trigger.action)if(t.containerMeta){const e=t.containerMeta.query(n.trigger.selector);e&&e.addEventListener(n.trigger.action,a)}else Y((()=>{const e=document.querySelector(n.trigger.selector);e&&e.addEventListener(n.trigger.action,a)}));else(i||n.trigger.state&&n.trigger.state===t.state)&&a();function a(a){n.messages.forEach((n=>{const r={...n.template},l=i&&(void 0===r.count||0!==r.count);let _=o.includes(s);if(s===yt.KEYDOWN&&t.whitelistedKeys){const e=a.keyCode;_=t.whitelistedKeys.includes(e)}(l||_)&&(t.isFromBackground?qt.messageDispatcher.sendTelemetry(JSON.stringify(r)):le(e,{telemetry:JSON.stringify(r)}))}))}}static handle(e){new Jt(e).fetchTelemetryHandlers(e.identifier).forEach((t=>{this.sendTelemetryMessages(e,t)}))}}const en="AI",tn="NO_AI",nn="FULL_BANNER",sn="ON_HOVER",on="ICON_ONLY",an="afterend",rn="afterbegin";class ln{constructor(e,t,n,i){this.waImageSecret=n,this.wpsCspClientId=i,this.strConvertor=new ce,this.colors={white:"#FFFFFF",red:"#C01818",black:"#343434"},this.bannerData={[en]:{bgc:this.colors.red,fontColor:this.colors.white,borderColor:"rgba(255, 255, 255, 0.4)",title:this.strConvertor.localeData("mb_video_banner_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_white.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/web_advisor/shield_white.svg")}?secret=${this.waImageSecret}`},[tn]:{bgc:this.colors.white,fontColor:this.colors.black,borderColor:"rgba(110, 110, 110, 0.4)",title:this.strConvertor.localeData("mb_video_banner_no_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_black.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/web_advisor/shield_red.svg")}?secret=${this.waImageSecret}`}},this.bannerId=e,this.videoElement=t,this.bannerNode=null,this.payload=null,this.timer=null,this.bannerType=null,this.topParentNode=null,this.isParentDefaultP=!1,this.srcUrl=null,this.bannerDetails=null,this.options={identifier:he.EVENT_NAME,wpsCspClientId:ve.toTlmWpsCspClientId(i)}}getBannerDetailsByVideoSize(){return this.videoElement.offsetWidth>=1081?(this.options.displayType=Oe.AI_ANNO_FULL_BANNER,{fontSize:22,lineHeight:37,bannerH:60,closeBtnH:30,aiIconSize:30,bannerAnimationType:nn}):this.videoElement.offsetWidth>=721?(this.options.displayType=Oe.AI_ANNO_HOVER_BANNER,{fontSize:18,lineHeight:28,bannerH:46,closeBtnH:23,aiIconSize:23,bannerAnimationType:sn}):this.videoElement.offsetWidth>=481?(this.options.displayType=Oe.AI_ANNO_HOVER_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:sn}):(this.options.displayType=Oe.AI_ANNO_ICON_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:on})}init(e,t){this.payload=t,this.bannerType=e,this.bannerDetails=this.getBannerDetailsByVideoSize(),this.injectfont(),this.bannerNode=document.createElement("div"),this.bannerNode.setAttribute("id",`${this.bannerId}`),this.initBannerListeners(),this.setBannerElement(),this.appendBannerToVideoContainer(),window.addEventListener("resize",(()=>{this.updateBannerPosition()}),!1),window.addEventListener("scroll",(()=>{this.updateBannerPosition()}),!1);const{srcurl:n,topurl:i}=this.payload;this.srcUrl=n??i,this.options.originFrom="videoBannerShow",this.options.bannerNodeSelector=`#${this.bannerId}`,this.options.aiAnnoType=e===en?Se:ye,Zt.handle(this.options)}injectfont(){try{const e=chrome.runtime.getURL("css/mcafee_fonts.css"),t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)}catch(e){ie.error(e)}}setBannerElement(){const{fontSize:e,closeBtnH:t,bannerH:i,lineHeight:s,aiIconSize:o,bannerAnimationType:a}=this.bannerDetails,r=this.bannerType;this.bannerType===en&&le(n,{payload:this.payload});const l=`\n      position: absolute;\n      top: 10px;\n      left: 10px;\n      padding-right: ${a===nn?"8px":"0px"};\n      border-radius: ${i}px;\n      margin: 10px;\n      z-index: 2147483647;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      font-family: McAfeePoppins, Arial !important;\n      opacity: 1;\n      box-shadow: 0 4px 4px 0 rgba(0, 0, 0, 0.2);\n      height: ${i}px;\n      width:  ${i}px;\n      background-color: ${this.bannerData[r].bgc};\n      gap: 3px;\n      overflow: hidden;\n      -webkit-transition: all 0.3s ease-in-out;\n      -moz-transition: all 0.3s ease-in-out;\n      transition: all 0.3s ease-in-out;\n      -webkit-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n    `;this.bannerNode.style=l;const _=`\n      height: ${o}px;\n      width: ${o}px;\n    `,c=`\n      display: flex;\n      color: ${this.bannerData[r].fontColor}; \n      line-height: ${s}px; \n      font-size: ${e}px; \n      font-weight: 600;\n      text-wrap: nowrap;\n    `,d=`\n      display: flex; \n      align-items: center; \n      border-left: 1px solid ${this.bannerData[r].borderColor};\n      margin: 0px 13px;\n      min-width: ${t}px;\n      min-height: ${t}px;\n    `,p=`\n      <div style='position: relative; height: ${i}px; width: ${i}px;'>\n        <div style='position: absolute; height: ${i}px; width: ${i}px; display: flex; justify-content: center; align-items: center'>\n          <img id='videoBannerIcon' src='${this.bannerData[r].icon}' style='${_}' />\n        </div>\n        <div style='height: ${i}px; width: ${i}px;'></div>\n      </div>\n    `,E=`\n      <div id="videoBannerContentContainer" style='display: flex; align-items: center; opacity: 0;'>\n        <div id='videoBannerTitle' style='${c}'>${this.bannerData[r].title}</div>\n        <div id='videoBannerCloseBtn' style='${d}'>\n          <img src='${this.bannerData[r].closeBtn}' style='padding-left:${e-8}px; height:${t}px;'/>\n        </div>\n      </div>\n    `,m=`${p}${on!==a?E:""}`;if(this.bannerNode.innerHTML=m,on!==a){const e=this.bannerNode.querySelector("#videoBannerCloseBtn");e?.addEventListener("click",(e=>{this.options.closeBtnClicked=!0,e.stopPropagation(),this.hideBanner()})),e&&(this.options.videoBannercloseBtn="#videoBannerCloseBtn")}a===nn&&setTimeout((()=>this.animateBanner(!0)),250),this.bannerType===tn&&this.closeBannerOnTimeout(this.bannerType)}initBannerListeners(){this.bannerNode.addEventListener("click",(e=>{e.stopPropagation(),le(t,{mbVideoId:this.payload.id});const{bannerAnimationType:n}=this.bannerDetails;on===n&&this.hideBanner()})),this.bannerNode.addEventListener("mouseenter",(({currentTarget:e})=>{this.options.displayType===Oe.AI_ANNO_HOVER_BANNER&&(this.options.originFrom="videoBannerHover",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",Zt.handle(this.options)),this.handleMouseEnterLeave("mouseenter",e)})),this.bannerNode.addEventListener("mouseleave",(({currentTarget:e})=>{this.handleMouseEnterLeave("mouseleave",e)}))}handleMouseEnterLeave(e){const{bannerAnimationType:t}=this.bannerDetails;t===sn&&this.animateBanner("mouseenter"===e),this.bannerType===tn&&("mouseenter"===e&&clearTimeout(this.timer),"mouseleave"===e&&this.closeBannerOnTimeout(this.bannerType))}animateBanner(e=!0){const{bannerH:t}=this.bannerDetails,n=this.bannerNode.querySelector("#videoBannerContentContainer");n&&(this.bannerNode.style.width=e?`${n.offsetWidth+t}px`:`${t}px`,this.bannerNode.style.paddingRight=e?"8px":"0px",n.style.opacity=e?1:0)}closeBannerOnTimeout(){this.timer=setTimeout((()=>{this.hideBanner(),this.options.aiAnnoType!==ye||this.options.closeBtnClicked||(this.options.originFrom="videoBannerFadeAway",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",Zt.handle(this.options))}),3e3)}hideBanner(){const{bannerAnimationType:e}=this.bannerDetails;on!==e&&this.animateBanner(!1),this.fadeOut(this.bannerNode,25,(()=>{this.bannerNode.innerHTML="",this.bannerNode.style.display="none"}))}updateBannerUI(e,t,n){this.srcUrl=t,this.payload=n,clearTimeout(this.timer),this.bannerType=e,this.setBannerElement(),this.updateBannerPosition()}appendBannerToVideoContainer(){this.topParentNode=(e=>{let t=e.parentElement;if(null===t)return e;let n=de(t);const i=de(e);let s=1,o=e;for(;null!==t&&i.top===n.top&&i.left===n.left&&s<3;)s++,o=t,t=t.parentElement,null!==t&&(n=de(t));return o})(this.videoElement),this.isParentDefaultP=["relative","fixed"].includes(window.getComputedStyle(this.topParentNode).getPropertyValue("position")),this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`;const e="VIDEO"===this.topParentNode.tagName?an:rn;this.topParentNode.insertAdjacentElement(e,this.bannerNode)}fadeIn(e,t,n){this.fadeInTimer=setInterval((()=>{e.style.opacity<1?e.style.opacity+=.2:(clearInterval(this.fadeInTimer),n())}),t)}fadeOut(e,t,n){this.fadeOutTimer=setInterval((()=>{e.style.opacity>0?e.style.opacity-=.2:(clearInterval(this.fadeOutTimer),n())}),t)}updateBannerPosition(){this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`}closeBanner(){this.bannerNode.innerHTML="",this.bannerNode.style.display="none"}}class _n{constructor(){this.banners={}}showBannerOnVideo(e,t){const{finalresult:n,srcurl:i,topurl:s,waImageSecret:o,wpsCspClientId:a,id:r}=t;if(0===e.offsetWidth||0===e.offsetHeight)return;const l=i??s;if(e.src&&e.src!==l)return void ie.log("[MB:showBannerOnVideo] video src changed, ignoring response from native to show banner.");const _=this.convertToBannerId(r),c=n?en:tn,{videoBanner:d}=this.getBannerById(_);if(!d){const n=new ln(_,e,o,a);return n.init(c,t),this.banners[_]={videoElement:e,videoBanner:n},void ie.log(`[MB:showBannerOnVideo] creating banner for bannerId=${_}, videoBanner.srcUrl=${n.srcUrl}`)}d.bannerType!==c?l===d.srcUrl&&c!==en||(ie.log(`[MB:showBannerOnVideo] already exists, updating UI for bannerId=${_}, updatedUrl=${l}, videoBanner.srcUrl=${d.srcUrl}`),d.updateBannerUI(c,l,t),this.banners[_]={videoElement:e,videoBanner:d}):ie.debug("[MB:showBannerOnVideo] prevent same banner type from showing.")}getBannerById(e){for(const[t,{videoBanner:n}]of Object.entries(this.banners))if(e===t)return{videoBanner:n};return{}}removeBannerFromVideo(e){const t=this.convertToBannerId(e),{videoBanner:n}=this.getBannerById(t);n&&(delete this.banners[t],n.closeBanner())}convertToBannerId(e){return`m${e.replace(/[{} -]/g,"")}`}}(new class extends oe{constructor(){super(i),this.bannerHandler=new _n,this.mockingbirdState=null,this.snoozedFinalResult={}}async main(){this.messageListener()}messageListener(){se("WA",null,(({request:e,sendResponse:t})=>{switch(e.command){case s:{const{payload:n}=e;return this.showBanner(n),t({content:!0}),!0}case o:{const{payload:n}=e;return this.removeBanner(n.id),t({content:!0}),!0}case a:{const{status:t,enabled:n}=e;return this.mockingbirdState={status:t,enabled:n},void(!this.mockingbirdState||this.mockingbirdState.enabled&&this.mockingbirdState.status===q||this.removeAllBanners())}}}))}showBanner(e){try{const{id:t,finalresult:n}=e,{element:i,capturing:s,permissionRequired:o}=window.audioMonitor.getById(t)||{};if(o)return;if(this.mockingbirdState&&(!this.mockingbirdState.enabled||this.mockingbirdState.status!==q))return void(this.mockingbirdState.status===$&&!this.snoozedFinalResult[t]&&n&&(this.snoozedFinalResult[t]=!0));if(e.status&&e.status===$)return void(!this.snoozedFinalResult[t]&&n&&(this.snoozedFinalResult[t]=!0));this.snoozedFinalResult[t]&&(e={...e,finalresult:1},delete this.snoozedFinalResult[t]),(s||n)&&i instanceof HTMLMediaElement?this.bannerHandler.showBannerOnVideo(i,e):(s||n)&&i instanceof HTMLAudioElement||i instanceof HTMLCanvasElement&&this.bannerHandler.showBannerOnVideo(i,e)}catch(e){ie.warn(`[MB] showBanner err, ${e.message}`)}}removeBanner(e){try{this.bannerHandler.removeBannerFromVideo(e),delete this.snoozedFinalResult[e]}catch(e){ie.warn(`[MB] removeBanner err, ${e.message}`)}}removeAllBanners(){(window.audioMonitor.audioInfos||[]).forEach((({id:e=null})=>this.removeBanner(e)))}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_mb_banner.js.map